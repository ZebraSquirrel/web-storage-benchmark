import{o as e}from"./rolldown-runtime-tX5UdD3f.js";import{a as t,c as n,d as r,i,l as a,n as o,o as s,p as c,r as l,s as u,t as d,u as f}from"./vendor-charts-pINOMcF7.js";import"./vendor-CEJ9tqYK.js";import{n as p,t as m}from"./vendor-react-Tbw7Ec2r.js";import{n as h,t as g}from"./vendor-db-core-BUpz2xyF.js";import{n as _,t as v}from"./vendor-db-utils-SJ_dCNbz.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var y=p(),b=c(),x=e(_(),1),S=e(g(),1),C=e(v(),1),w=S.default.default||S.default,T=class{constructor(){this.name=`localStorage`}async write(e,t){localStorage.setItem(e,t)}async read(e){return localStorage.getItem(e)}async delete(e){localStorage.removeItem(e)}async clear(){localStorage.clear()}},E=class{constructor(){this.name=`sessionStorage`}async write(e,t){sessionStorage.setItem(e,t)}async read(e){return sessionStorage.getItem(e)}async delete(e){sessionStorage.removeItem(e)}async clear(){sessionStorage.clear()}},D=class{constructor(){this.name=`IndexedDB`,this.dbName=`benchmark_db`,this.storeName=`entries`}async getDB(){return new Promise((e,t)=>{let n=indexedDB.open(this.dbName,1);n.onupgradeneeded=()=>{n.result.createObjectStore(this.storeName)},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})}async write(e,t){let n=await this.getDB();return new Promise((r,i)=>{let a=n.transaction(this.storeName,`readwrite`).objectStore(this.storeName).put(t,e);a.onsuccess=()=>r(),a.onerror=()=>i(a.error)})}async read(e){let t=await this.getDB();return new Promise((n,r)=>{let i=t.transaction(this.storeName,`readonly`).objectStore(this.storeName).get(e);i.onsuccess=()=>n(i.result||null),i.onerror=()=>r(i.error)})}async delete(e){let t=await this.getDB();return new Promise((n,r)=>{let i=t.transaction(this.storeName,`readwrite`).objectStore(this.storeName).delete(e);i.onsuccess=()=>n(),i.onerror=()=>r(i.error)})}async clear(){let e=await this.getDB();return new Promise((t,n)=>{let r=e.transaction(this.storeName,`readwrite`).objectStore(this.storeName).clear();r.onsuccess=()=>t(),r.onerror=()=>n(r.error)})}},O=class{constructor(){this.name=`Cache Storage`,this.cacheName=`benchmark_cache`}async write(e,t){await(await caches.open(this.cacheName)).put(new Request(e),new Response(t))}async read(e){let t=await(await caches.open(this.cacheName)).match(new Request(e));return t?await t.text():null}async delete(e){await(await caches.open(this.cacheName)).delete(new Request(e))}async clear(){await caches.delete(this.cacheName)}},k=class{constructor(){this.name=`Cookies`}async write(e,t){document.cookie=`${encodeURIComponent(e)}=${encodeURIComponent(t)}; path=/; Max-Age=3600`}async read(e){let t=encodeURIComponent(e)+`=`,n=document.cookie.split(`;`);for(let e=0;e<n.length;e++){let r=n[e];for(;r.charAt(0)===` `;)r=r.substring(1,r.length);if(r.indexOf(t)===0)return decodeURIComponent(r.substring(t.length,r.length))}return null}async delete(e){document.cookie=`${encodeURIComponent(e)}=; path=/; Max-Age=-99999999;`}async clear(){let e=document.cookie.split(`;`);for(let t=0;t<e.length;t++){let n=e[t].split(`=`)[0].trim();await this.delete(n)}}},A=class{constructor(){this.name=`Dexie.js`,this.db=new h(`dexie_benchmark`),this.db.version(1).stores({entries:`key`})}async write(e,t){await this.db.entries.put({key:e,value:t})}async read(e){let t=await this.db.entries.get(e);return t?t.value:null}async delete(e){await this.db.entries.delete(e)}async clear(){await this.db.entries.clear()}},j=class{constructor(){this.name=`store.js`}async write(e,t){x.default.set(e,t)}async read(e){return x.default.get(e)||null}async delete(e){x.default.remove(e)}async clear(){x.default.clearAll()}},M=class{constructor(){this.name=`PouchDB`,this.db=new w(`pouch_benchmark`)}async write(e,t){try{let n=await this.db.get(e);await this.db.put({...n,value:t})}catch(n){if(n.status===404)await this.db.put({_id:e,value:t});else throw n}}async read(e){try{return(await this.db.get(e)).value}catch(e){if(e.status===404)return null;throw e}}async delete(e){try{let t=await this.db.get(e);await this.db.remove(t)}catch(e){if(e.status!==404)throw e}}async clear(){let e=(await this.db.allDocs()).rows.map(e=>({_id:e.id,_rev:e.value.rev,_deleted:!0}));await this.db.bulkDocs(e)}},N=class{constructor(){this.name=`localForage`,C.default.config({name:`localforage_benchmark`})}async write(e,t){await C.default.setItem(e,t)}async read(e){return await C.default.getItem(e)}async delete(e){await C.default.removeItem(e)}async clear(){await C.default.clear()}},P=class{constructor(){this.name=`OPFS`}async getRoot(){if(!navigator.storage||!navigator.storage.getDirectory)throw Error(`OPFS not supported`);return await navigator.storage.getDirectory()}async write(e,t){let n=await(await(await this.getRoot()).getFileHandle(e,{create:!0})).createWritable();await n.write(t),await n.close()}async read(e){try{return await(await(await(await this.getRoot()).getFileHandle(e)).getFile()).text()}catch{return null}}async delete(e){await(await this.getRoot()).removeEntry(e)}async clear(){let e=await this.getRoot();for await(let t of e.keys())await e.removeEntry(t,{recursive:!0})}};const F=[{name:`Save a preference (128 B)`,payloads:[{label:`128 B`,size:128}]},{name:`Persist UI state (1 KB)`,payloads:[{label:`1 KB`,size:1024}]},{name:`Persist UI state (10 KB)`,payloads:[{label:`10 KB`,size:10*1024}]},{name:`Offline dataset (100 KB)`,payloads:[{label:`100 KB`,size:100*1024}]},{name:`Offline dataset (1 MB)`,payloads:[{label:`1 MB`,size:1024*1024}]},{name:`Offline dataset (2 MB)`,payloads:[{label:`2 MB`,size:2*1024*1024}]},{name:`Offline dataset (4 MB)`,payloads:[{label:`4 MB`,size:4*1024*1024}]},{name:`Offline dataset (8 MB)`,payloads:[{label:`8 MB`,size:8*1024*1024}]},{name:`Offline dataset (16 MB)`,payloads:[{label:`16 MB`,size:16*1024*1024}]},{name:`Large dataset (32 MB)`,payloads:[{label:`32 MB`,size:32*1024*1024}]},{name:`Large dataset (64 MB)`,payloads:[{label:`64 MB`,size:64*1024*1024}]},{name:`Large dataset (100 MB)`,payloads:[{label:`100 MB`,size:100*1024*1024}]}];function I(e){return`a`.repeat(e)}var L=e=>new Promise(t=>setTimeout(t,e));async function R(e,t,n){await e.clear();let r=performance.now();await e.write(t,n);let i=performance.now()-r,a=performance.now();return await e.read(t),{writeTime:i,readTime:performance.now()-a}}async function z(e,t){let n=[];for(let r of t.payloads){let i=I(r.size),a=`bench_${r.label}`;try{let{writeTime:o,readTime:s}=await R(e,a,i),c=o+s,l=1,u=1;for(c<10?u=3:c<50&&(u=2);l<u;){await L(50);let t=await R(e,a,i);o+=t.writeTime,s+=t.readTime,l++}o/=l,s/=l;let d=e.name===`localStorage`||e.name===`sessionStorage`||e.name===`Cookies`?o+s:.5;n.push({adapterName:e.name,suiteName:t.name,payloadSize:r.label,writeTime:o,readTime:s,blockingTime:d})}catch(i){n.push({adapterName:e.name,suiteName:t.name,payloadSize:r.label,writeTime:0,readTime:0,blockingTime:0,error:i.message||`Quota exceeded or unknown error`})}}return n}async function B(e){for(let t of e)try{await t.clear()}catch(e){console.error(`Failed to clear ${t.name}`,e)}}var V=m(),H=[new T,new E,new D,new O,new k,new A,new j,new M,new N,new P],U={localStorage:`#4ade80`,sessionStorage:`#60a5fa`,IndexedDB:`#fbbf24`,"Cache Storage":`#f97316`,Cookies:`#f87171`,"Dexie.js":`#22d3ee`,"store.js":`#e879f9`,PouchDB:`#a3e635`,localForage:`#818cf8`,OPFS:`#2dd4bf`},W=e=>`storage-${e.toLowerCase().replace(/\s+/g,`-`).replace(/\./g,`-`)}`;function G(){let[e,c]=(0,b.useState)([]),[p,m]=(0,b.useState)(!1),[h,g]=(0,b.useState)(H.map(e=>e.name)),[_,v]=(0,b.useState)(()=>typeof window<`u`?window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`:`dark`);(0,b.useEffect)(()=>{document.documentElement.setAttribute(`data-theme`,_)},[_]);let y=()=>{v(e=>e===`dark`?`light`:`dark`)},x=e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},S=(0,b.useMemo)(()=>[...H].sort((e,t)=>{let n=h.includes(e.name),r=h.includes(t.name);return n&&!r?-1:!n&&r?1:0}),[h]),C=(0,b.useMemo)(()=>{let t=new Set;return F.map(n=>{let r={name:n.payloads[0].label};return H.forEach(i=>{let a=e.find(e=>e.suiteName===n.name&&e.adapterName===i.name);if(a?.error&&t.add(i.name),t.has(i.name))r[i.name]=null;else if(a){let e=parseFloat((a.writeTime+a.readTime).toFixed(2));r[i.name]=Math.max(e,.01)}else r[i.name]=null}),r})},[e]),w=async()=>{m(!0),c([]);let e=[];for(let t of F)for(let n of H)try{let r=await z(n,t);e.push(...r),c([...e])}catch(e){console.error(`Failed suite ${t.name} for ${n.name}`,e)}await B(H),m(!1)},T=t=>e.filter(e=>e.suiteName===t).sort((e,t)=>e.error&&!t.error?1:!e.error&&t.error?-1:e.writeTime+e.readTime-(t.writeTime+t.readTime));return(0,V.jsxs)(`div`,{className:`container`,children:[(0,V.jsx)(`div`,{className:`theme-toggle-container`,children:(0,V.jsx)(`button`,{className:`theme-toggle-btn`,onClick:y,"aria-label":`Toggle Theme`,children:_===`dark`?(0,V.jsx)(o,{size:20}):(0,V.jsx)(l,{size:20})})}),(0,V.jsxs)(`header`,{children:[(0,V.jsxs)(`div`,{className:`title-row`,children:[(0,V.jsx)(`img`,{src:`/database-stats.svg`,alt:`Logo`,className:`header-logo`}),(0,V.jsx)(`h1`,{children:`Web Storage Benchmark`})]}),(0,V.jsx)(`p`,{className:`subtitle`,children:`Comparing performance across various web storage technologies`}),(0,V.jsx)(`button`,{className:`run-all-btn`,onClick:w,disabled:p,children:_===`dark`&&p?`Benchmarking...`:p?`Running...`:`Run All Benchmarks`})]}),(0,V.jsxs)(`section`,{className:`chart-section`,children:[(0,V.jsx)(`div`,{className:`chart-header`,children:(0,V.jsxs)(`div`,{className:`chart-title`,children:[(0,V.jsx)(i,{size:20}),(0,V.jsx)(`h2`,{children:`Performance Efficiency (Total Time)`})]})}),(0,V.jsx)(`div`,{className:`custom-legend`,children:S.map(e=>{let t=h.includes(e.name);return(0,V.jsxs)(`button`,{className:`legend-badge ${t?``:`inactive`}`,onClick:()=>x(e.name),style:{"--badge-color":U[e.name]},children:[(0,V.jsx)(`span`,{className:`badge-dot`}),(0,V.jsx)(`span`,{className:`badge-label`,children:e.name}),t&&(0,V.jsx)(d,{size:12,className:`badge-remove`})]},e.name)})}),(0,V.jsx)(`div`,{className:`chart-container`,children:(0,V.jsx)(r,{width:`100%`,height:600,children:(0,V.jsxs)(t,{data:C,margin:{top:10,right:30,left:10,bottom:0},children:[(0,V.jsx)(a,{strokeDasharray:`3 3`,stroke:`rgba(128,128,128,0.1)`,vertical:!1}),(0,V.jsx)(u,{dataKey:`name`,stroke:`#64748b`,fontSize:12,tickLine:!1,axisLine:!1}),(0,V.jsx)(s,{stroke:`#64748b`,fontSize:12,tickLine:!1,axisLine:!1,scale:`log`,domain:[`auto`,`auto`],label:{value:`ms`,angle:-90,position:`insideLeft`,fill:`#64748b`,offset:0}}),(0,V.jsx)(f,{contentStyle:{backgroundColor:`var(--card-bg)`,border:`1px solid var(--border-color)`,borderRadius:`8px`,fontSize:`12px`,color:`var(--text-primary)`},itemStyle:{padding:`2px 0`},itemSorter:e=>-e.value}),H.map(e=>(0,V.jsx)(n,{type:`monotone`,dataKey:e.name,stroke:U[e.name],strokeWidth:3,hide:!h.includes(e.name),dot:{r:4,fill:U[e.name],strokeWidth:0,fillOpacity:1},activeDot:{r:6,strokeWidth:0},connectNulls:!1,isAnimationActive:!1},e.name))]})})})]}),(0,V.jsx)(`div`,{className:`benchmarks-grid`,children:F.map(e=>{let t=T(e.name);return(0,V.jsxs)(`div`,{className:`suite-card`,children:[(0,V.jsx)(`div`,{className:`suite-card-header`,children:(0,V.jsx)(`h2`,{children:e.name})}),(0,V.jsxs)(`table`,{children:[(0,V.jsx)(`thead`,{children:(0,V.jsxs)(`tr`,{children:[(0,V.jsx)(`th`,{children:`Storage`}),(0,V.jsx)(`th`,{children:`Write (ms)`}),(0,V.jsx)(`th`,{children:`Read (ms)`})]})}),(0,V.jsxs)(`tbody`,{children:[t.map((e,t)=>(0,V.jsxs)(`tr`,{children:[(0,V.jsx)(`td`,{className:`${t===0&&!e.error?`rank-1`:``} ${W(e.adapterName)}`,children:e.adapterName}),(0,V.jsx)(`td`,{className:e.error?`error-cell`:``,children:e.error?`❌`:e.writeTime.toFixed(2)}),(0,V.jsx)(`td`,{className:e.error?`error-cell`:``,children:e.error?`❌`:e.readTime.toFixed(2)})]},`${e.adapterName}-${e.payloadSize}`)),t.length===0&&(0,V.jsx)(`tr`,{children:(0,V.jsx)(`td`,{colSpan:3,style:{textAlign:`center`,opacity:.5},children:`No results yet. Run benchmarks to see data.`})})]})]})]},e.name)})})]})}var K=G;(0,y.createRoot)(document.getElementById(`root`)).render((0,V.jsx)(b.StrictMode,{children:(0,V.jsx)(K,{})}));